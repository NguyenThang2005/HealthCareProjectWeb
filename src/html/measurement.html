<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đo chỉ số sức khỏe | HealthFit</title>
    
    <link rel="stylesheet" href="/assets/css/charts.css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" href="/images/tab.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
    <style>
    </style>
</head>
<body class="font-sans bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <img src="/images/logo.jpg" alt="HealthFit Logo" class="h-12">
                <h1 class="text-2xl font-bold text-green-600">HealthFit</h1>
            </div>
            <nav class="hidden md:flex space-x-8">
                <a href="index.html" class="text-gray-800 hover:text-green-600 font-medium">Trang chủ</a>
                <a href="measurement.html" class="text-gray-800 hover:text-green-600 font-medium active">Đo chỉ số</a>
                <a href="equipment.html" class="text-gray-800 hover:text-green-600 font-medium">Hướng dẫn thiết bị</a>
                <a href="news.html" class="text-gray-800 hover:text-green-600 font-medium">Tin tức</a>
                <a href="trainers.html" class="text-gray-800 hover:text-green-600 font-medium">Huấn luyện viên</a>
                <a href="products.html" class="text-gray-800 hover:text-green-600 font-medium">Sản phẩm</a>
                <a href="feedback.html" class="text-gray-800 hover:text-green-600 font-medium">Góp ý</a>
            </nav>

            <div class="flex items-center space-x-4">
                <!-- Login Button -->
                <button id="loginBtn" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition">Đăng nhập</button>

                <!-- User Icon (hidden by default) -->
                <a id="userIcon" href="/user/user.html" class="hidden">
                    <img src="https://megaweb.vn/blog/uploads/images/meme-meo-cute-1.jpg" alt="Avatar" class="w-10 h-10 rounded-full cursor-pointer border-2 border-green-600">
                </a>

                <button id="menuBtn" class="md:hidden text-gray-800 text-2xl">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden bg-white border-t">
            <div class="container mx-auto px-4 py-2 flex flex-col space-y-2">
                <a href="index.html" class="text-gray-800 hover:text-green-600 py-2">Trang chủ</a> 
                <a href="measurement.html" class="text-gray-800 hover:text-green-600 py-2">Đo chỉ số</a>
                <a href="equipment.html" class="text-gray-800 hover:text-green-600 py-2">Hướng dẫn thiết bị</a>
                <a href="news.html" class="text-gray-800 hover:text-green-600 py-2">Tin tức</a>
                <a href="trainers.html" class="text-gray-800 hover:text-green-600 py-2">Huấn luyện viên</a>
                <a href="products.html" class="text-gray-800 hover:text-green-600 py-2">Sản phẩm</a>
                <a href="feedback.html" class="text-gray-800 hover:text-green-600 font-medium">Góp ý</a>
            </div>
        </div>
    </header>

    <!-- Measurement Section -->
    <section class="py-12 measurement-section">
        <div class="container mx-auto px-4">
            <h1 class="text-3xl font-bold mb-8">Theo dõi chỉ số sức khỏe</h1>
            
            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <!-- Measurement Form -->
                <div class="p-6 rounded-lg shadow-md bg-white">
                    <h2 class="text-xl font-bold mb-4">Nhập chỉ số của bạn</h2>
                    <form id="measurementForm">
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="height" class="block text-gray-700 mb-2">Chiều cao (cm)</label>
                                <input type="number" id="height" name="height" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500" required>
                            </div>
                            <div>
                                <label for="weight" class="block text-gray-700 mb-2">Cân nặng (kg)</label>
                                <input type="number" id="weight" name="weight" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500" step="0.1" required>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="fat_percentage" class="block text-gray-700 mb-2">Tỷ lệ mỡ (%)</label>
                                <input type="number" id="fat_percentage" name="fat_percentage" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500" step="0.1">
                            </div>
                            <div>
                                <label for="muscle_mass" class="block text-gray-700 mb-2">Khối lượng cơ (kg)</label>
                                <input type="number" id="muscle_mass" name="muscle_mass" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500" step="0.1">
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="date" class="block text-gray-700 mb-2">Ngày đo</label>
                            <input type="date" id="date" name="date" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500" required>
                        </div>
                        
                        <div class="mb-4">
                            <label for="notes" class="block text-gray-700 mb-2">Ghi chú</label>
                            <textarea id="notes" name="notes" rows="3" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500"></textarea>
                        </div>
                        
                        <button type="submit" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition">Lưu chỉ số</button>
                    </form>
                </div>
                
                <!-- Measurement Summary -->
                <div class="p-6 rounded-lg shadow-md bg-white">
                    <h2 class="text-xl font-bold mb-4">Tổng quan sức khỏe</h2>
                    <div class="grid grid-cols-3 gap-4 text-center mb-6">
                        <div>
                            <div id="bmiValue" class="text-3xl font-bold text-green-600">--</div>
                            <div class="text-gray-600">BMI</div>
                            <div id="bmiStatus" class="text-sm text-gray-500">Chưa có dữ liệu</div>
                        </div>
                        <div>
                            <div id="fatValue" class="text-3xl font-bold text-blue-600">--</div>
                            <div class="text-gray-600">Mỡ cơ thể</div>
                            <div id="fatStatus" class="text-sm text-gray-500">Chưa có dữ liệu</div>
                        </div>
                        <div>
                            <div id="muscleValue" class="text-3xl font-bold text-purple-600">--</div>
                            <div class="text-gray-600">Cơ bắp</div>
                            <div id="muscleStatus" class="text-sm text-gray-500">Chưa có dữ liệu</div>
                        </div>
                    </div>
                    
                    <!-- Health Chart -->
                    <div class="mb-6">
                        <canvas id="healthChart" height="150"></canvas>
                    </div>
                    
                    <!-- Recommendations -->
                    <div>
                        <h3 class="text-lg font-semibold mb-2">Khuyến nghị</h3>
                        <ul id="recommendations" class="list-disc pl-5 space-y-1 text-gray-700">
                            <li>Vui lòng nhập chỉ số để nhận khuyến nghị</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Measurement History -->
            <div class="p-6 rounded-lg shadow-md bg-white">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold">Lịch sử đo</h2>
                    <button id="refreshHistory" class="text-green-600 hover:text-green-800">
                        <i class="fas fa-sync-alt mr-1"></i> Làm mới
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white">
                        <thead>
                            <tr class="bg-gray-100">
                                <th class="py-3 px-4 border-b text-left">Ngày</th>
                                <th class="py-3 px-4 border-b text-left">Cân nặng (kg)</th>
                                <th class="py-3 px-4 border-b text-left">Chiều cao (cm)</th>
                                <th class="py-3 px-4 border-b text-left">BMI</th>
                                <th class="py-3 px-4 border-b text-left">Mỡ (%)</th>
                                <th class="py-3 px-4 border-b text-left">Cơ (kg)</th>
                                <th class="py-3 px-4 border-b text-left">Ghi chú</th>
                                <th class="py-3 px-4 border-b text-left">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody id="measurementHistory">
                            <tr>
                                <td colspan="8" class="text-center text-gray-500 py-4">Vui lòng nhập chỉ số mới để xem lịch sử</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">HealthFit</h3>
                    <p class="text-gray-300">Nền tảng chăm sóc sức khỏe và thể hình toàn diện.</p>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Liên kết nhanh</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-300 hover:text-white">Trang chủ</a></li>
                        <li><a href="measurement.html" class="text-gray-300 hover:text-white">Đo chỉ số</a></li>
                        <li><a href="equipment.html" class="text-gray-300 hover:text-white">Hướng dẫn thiết bị</a></li>
                        <li><a href="trainers.html" class="text-gray-300 hover:text-white">Huấn luyện viên</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Liên hệ</h3>
                    <ul class="space-y-2">
                        <li class="flex items-center">
                            <i class="fas fa-map-marker-alt text-green-500 mr-2"></i>
                            <span class="text-gray-300">Số 2 Võ Oanh, Bình Thạnh, TP.HCM</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone text-green-500 mr-2"></i>
                            <span class="text-gray-300">(028) 3823 4567</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-envelope text-green-500 mr-2"></i>
                            <span class="text-gray-300">support@healthfit.vn</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Đăng ký nhận tin</h3>
                    <form class="flex">
                        <input type="email" placeholder="Email của bạn" class="px-4 py-2 rounded-l focus:outline-none w-full text-gray-800">
                        <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded-r hover:bg-green-700">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>© 2025 HealthFit. <a href="https://nguyenthang2005.github.io/Nhom7_CV/">Tất cả các quyền được bảo lưu.</a></p>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-8 max-w-md w-full">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">Đăng nhập</h2>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
                <form id="loginForm" action="/php/auth.php" method="POST">
                <div class="mb-4">
                    <label for="email" class="block text-gray-700 mb-2">Email</label>
                    <input type="email" id="email" name="email" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500" required>
                </div>
                <div class="mb-6">
                    <label for="password" class="block text-gray-700 mb-2">Mật khẩu</label>
                    <input type="password" id="password" name="password" class="w-full px-4 py-2 border rounded focus:outline-none focus:border-green-500" required>
                </div>
                <button type="submit" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 mb-4">Đăng nhập</button>
                <div class="text-center">
                    <a href="#" class="text-green-600 hover:underline">Quên mật khẩu?</a>
                </div>
            </form>
            <div class="mt-4 pt-4 border-t border-gray-200 text-center">
                <p class="text-gray-600">Chưa có tài khoản? <a href="register.html" class="text-green-600 hover:underline">Đăng ký ngay</a></p>
            </div>
        </div>
    </div>

<script src="/assets/js/app.js"></script>
<script src="/assets/js/session_check.js"></script>
<script>
    // Global variables
    let healthChart;

    // Get today's date in local time (not UTC)
    const currentDate = new Date();
    const year = currentDate.getFullYear();
    const month = String(currentDate.getMonth() + 1).padStart(2, '0');
    const day = String(currentDate.getDate()).padStart(2, '0');
    const formattedDate = `${year}-${month}-${day}`; // YYYY-MM-DD

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', function () {
        const dateInput = document.getElementById('date');
        dateInput.value = formattedDate;
        dateInput.min = formattedDate;
        dateInput.max = formattedDate;
        dateInput.readOnly = true;

        // Add styling for readonly date input
        const style = document.createElement('style');
        style.textContent = `
            input[type="date"][readonly] {
                background-color: #f3f4f6;
                cursor: not-allowed;
            }
        `;
        document.head.appendChild(style);

        // Initialize chart
        initHealthChart();

        // Load existing measurements
        loadMeasurements();

        // Set up form submission
        document.getElementById('measurementForm').addEventListener('submit', handleFormSubmit);

        // Refresh button
        document.getElementById('refreshHistory').addEventListener('click', loadMeasurements);
    });

    function initHealthChart() {
        const ctx = document.getElementById('healthChart').getContext('2d');
        healthChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'BMI',
                        data: [],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Body Fat %',
                        data: [],
                        borderColor: '#3B82F6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Muscle Mass (kg)',
                        data: [],
                        borderColor: '#8B5CF6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.3,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }

    function handleFormSubmit(e) {
        e.preventDefault();
        const form = e.target;
        const now = new Date();

        const data = {
            id: now.getTime(),
            height: parseFloat(form.height.value),
            weight: parseFloat(form.weight.value),
            fat_percentage: form.fat_percentage.value ? parseFloat(form.fat_percentage.value) : null,
            muscle_mass: form.muscle_mass.value ? parseFloat(form.muscle_mass.value) : null,
            date: formattedDate,
            timestamp: now.toISOString(),
            notes: form.notes.value
        };

        if (!data.height || !data.weight) {
            alert('Vui lòng nhập chiều cao và cân nặng!');
            return;
        }

        try {
            const bmi = (data.weight / ((data.height / 100) ** 2)).toFixed(1);
            let measurements = JSON.parse(localStorage.getItem('healthMeasurements')) || [];
            measurements.push(data);
            localStorage.setItem('healthMeasurements', JSON.stringify(measurements));

            updateSummary(data, bmi);
            loadMeasurements();
            form.reset();
            form.date.value = formattedDate;

            const timeString = now.toLocaleTimeString();
            alert(`Đã lưu kết quả đo lúc ${timeString}`);
        } catch (error) {
            console.error('Lỗi khi lưu chỉ số:', error);
            alert('Có lỗi xảy ra khi lưu chỉ số. Vui lòng thử lại.');
        }
    }

    function loadMeasurements() {
        const measurements = JSON.parse(localStorage.getItem('healthMeasurements')) || [];

        if (measurements.length === 0) {
            document.getElementById('measurementHistory').innerHTML = `
                <tr>
                    <td colspan="8" class="text-center py-4">Chưa có dữ liệu đo lường</td>
                </tr>`;
            healthChart.data.labels = [];
            healthChart.data.datasets.forEach(dataset => dataset.data = []);
            healthChart.update();
        } else {
            displayMeasurements(measurements);
            updateChart(measurements);

            const latest = measurements.reduce((prev, current) =>
                new Date(prev.timestamp) > new Date(current.timestamp) ? prev : current
            );
            const bmi = (latest.weight / ((latest.height / 100) ** 2)).toFixed(1);
            updateSummary(latest, bmi);
        }
    }

    function displayMeasurements(measurements) {
        const tbody = document.getElementById('measurementHistory');
        tbody.innerHTML = '';
        measurements.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

        measurements.forEach(m => {
            const bmi = (m.weight / ((m.height / 100) ** 2)).toFixed(1);
            const date = new Date(m.timestamp);
            const dateString = formatDate(m.date);
            const timeString = date.toLocaleTimeString();

            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50';
            row.innerHTML = `
                <td class="p-3 border-b">${dateString} ${timeString}</td>
                <td class="p-3 border-b">${m.weight.toFixed(1)}</td>
                <td class="p-3 border-b">${m.height}</td>
                <td class="p-3 border-b">${bmi}</td>
                <td class="p-3 border-b">${m.fat_percentage?.toFixed(1) || '-'}</td>
                <td class="p-3 border-b">${m.muscle_mass?.toFixed(1) || '-'}</td>
                <td class="p-3 border-b">${m.notes || '-'}</td>
                <td class="p-3 border-b">
                    <button class="text-red-500 hover:text-red-700 delete-btn" data-id="${m.id}">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </td>`;
            tbody.appendChild(row);
        });

        document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                const id = parseInt(this.getAttribute('data-id'));
                deleteMeasurement(id);
            });
        });
    }

    function deleteMeasurement(id) {
        if (confirm('Bạn có chắc chắn muốn xóa bản ghi này?')) {
            let measurements = JSON.parse(localStorage.getItem('healthMeasurements')) || [];
            measurements = measurements.filter(m => m.id !== id);
            localStorage.setItem('healthMeasurements', JSON.stringify(measurements));
            loadMeasurements();
        }
    }

    function updateSummary(data, bmi) {
        document.getElementById('bmiValue').textContent = bmi;
        document.getElementById('fatValue').textContent = data.fat_percentage ? data.fat_percentage.toFixed(1) + '%' : '--';
        document.getElementById('muscleValue').textContent = data.muscle_mass ? data.muscle_mass.toFixed(1) + 'kg' : '--';

        const bmiStatus = document.getElementById('bmiStatus');
        if (bmi < 18.5) {
            bmiStatus.textContent = 'Thiếu cân';
            bmiStatus.className = 'text-sm text-blue-500';
        } else if (bmi < 23) {
            bmiStatus.textContent = 'Bình thường';
            bmiStatus.className = 'text-sm text-green-500';
        } else if (bmi < 25) {
            bmiStatus.textContent = 'Tiền béo phì';
            bmiStatus.className = 'text-sm text-yellow-500';
        } else if (bmi < 30) {
            bmiStatus.textContent = 'Béo phì độ I';
            bmiStatus.className = 'text-sm text-orange-500';
        } else {
            bmiStatus.textContent = 'Béo phì độ II, III';
            bmiStatus.className = 'text-sm text-red-500';
        }

        if (data.fat_percentage) {
            const fatStatus = document.getElementById('fatStatus');
            if (data.fat_percentage < 15) {
                fatStatus.textContent = 'Rất gầy';
                fatStatus.className = 'text-sm text-blue-500';
            } else if (data.fat_percentage < 20) {
                fatStatus.textContent = 'Tốt';
                fatStatus.className = 'text-sm text-green-500';
            } else if (data.fat_percentage < 25) {
                fatStatus.textContent = 'Hơi cao';
                fatStatus.className = 'text-sm text-yellow-500';
            } else {
                fatStatus.textContent = 'Cao';
                fatStatus.className = 'text-sm text-red-500';
            }
        }

        if (data.muscle_mass) {
            const muscleStatus = document.getElementById('muscleStatus');
            const muscleRatio = (data.muscle_mass / data.weight * 100).toFixed(1);

            if (muscleRatio > 40) {
                muscleStatus.textContent = 'Rất tốt';
                muscleStatus.className = 'text-sm text-green-500';
            } else if (muscleRatio > 35) {
                muscleStatus.textContent = 'Tốt';
                muscleStatus.className = 'text-sm text-green-500';
            } else if (muscleRatio > 30) {
                muscleStatus.textContent = 'Trung bình';
                muscleStatus.className = 'text-sm text-yellow-500';
            } else {
                muscleStatus.textContent = 'Thấp';
                muscleStatus.className = 'text-sm text-red-500';
            }
        }

        updateRecommendations(bmi, data.fat_percentage);
    }

    function updateRecommendations(bmi, fatPercentage) {
        const recommendations = document.getElementById('recommendations');
        recommendations.innerHTML = '';

        if (bmi < 18.5) {
            recommendations.innerHTML += '<li>Tăng khẩu phần ăn giàu protein và chất béo lành mạnh</li>';
            recommendations.innerHTML += '<li>Tập luyện sức mạnh 3-4 lần/tuần</li>';
            recommendations.innerHTML += '<li>Ngủ đủ 7-8 tiếng mỗi đêm</li>';
        } else if (bmi < 23) {
            recommendations.innerHTML += '<li>Duy trì chế độ ăn cân bằng</li>';
            recommendations.innerHTML += '<li>Tập luyện đa dạng: cardio và strength</li>';
            recommendations.innerHTML += '<li>Uống đủ nước (2-3 lít/ngày)</li>';
        } else {
            recommendations.innerHTML += '<li>Giảm lượng tinh bột và đường</li>';
            recommendations.innerHTML += '<li>Tập cardio 4-5 lần/tuần</li>';
            recommendations.innerHTML += '<li>Tăng cường rau xanh và chất xơ</li>';
        }

        if (fatPercentage) {
            if (fatPercentage > 20) {
                recommendations.innerHTML += '<li>Giảm đồ ăn nhanh và thức ăn nhiều dầu mỡ</li>';
                recommendations.innerHTML += '<li>Tập HIIT 2-3 lần/tuần</li>';
            } else if (fatPercentage < 15) {
                recommendations.innerHTML += '<li>Tăng lượng calo từ nguồn lành mạnh</li>';
                recommendations.innerHTML += '<li>Hạn chế cardio quá nhiều</li>';
            }
        }
    }

    function updateChart(data) {
        const sorted = [...data].sort((a, b) => new Date(a.date) - new Date(b.date));
        const labels = sorted.map(m => formatDate(m.date));
        const bmiData = sorted.map(m => (m.weight / ((m.height / 100) ** 2)).toFixed(1));
        const fatData = sorted.map(m => m.fat_percentage || null);
        const muscleData = sorted.map(m => m.muscle_mass || null);

        healthChart.data.labels = labels;
        healthChart.data.datasets[0].data = bmiData;
        healthChart.data.datasets[1].data = fatData;
        healthChart.data.datasets[2].data = muscleData;
        healthChart.update();
    }

    function formatDate(dateString) {
        const date = new Date(dateString);
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const year = date.getFullYear();
        return `${day}/${month}/${year}`;
    }
    const data = {
  height: parseFloat(document.getElementById('height').value),
  weight: parseFloat(document.getElementById('weight').value),
  fat_percentage: parseFloat(document.getElementById('fat_percent').value),
  muscle_mass: parseFloat(document.getElementById('muscle_mass').value),
  date: document.getElementById('date').value,
  notes: document.getElementById('notes').value
};

fetch('/src/php/update_measurements.php', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(data)
})
.then(res => res.json())
.then(res => {
  if (res.status === 'success') {
    alert('Đã lưu thành công');
    location.reload();
  } else {
    alert('Lỗi: ' + res.message);
  }
});

</script>

</body>
</html>